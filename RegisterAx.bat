cd /d %~dp0
:: =======Register XD source filter==========
regsvr32  -s XDSource.ax

:: ===========Registry some information about CoreAVCDecoder==============
:: ------------------Add e-mail and Serial.------------------------------
REG ADD HKLM\SOFTWARE\CoreCodec /f
REG ADD "HKLM\SOFTWARE\CoreCodec\CoreAVC Pro 3.x" /f
REG ADD "HKLM\SOFTWARE\CoreCodec\CoreAVC Pro 3.x" /v User /t REG_SZ /d rbogaar@aol.com /f
REG ADD "HKLM\SOFTWARE\CoreCodec\CoreAVC Pro 3.x" /v Serial /t REG_SZ /d TBCYS8-Q18CKZ-8FHGG8-F49LTA-UK8AQQ /f
:: --------------------Add hex filter data.--------------------------------
REG ADD HKCR\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{09571A4B-F1FE-4C60-9760-DE6D310C7C31} /f
REG ADD HKCR\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{09571A4B-F1FE-4C60-9760-DE6D310C7C31} ^
/v FriendlyName /t REG_SZ /d "CoreAVC Video Decoder" /f
REG ADD HKCR\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{09571A4B-F1FE-4C60-9760-DE6D310C7C31} ^
/v CLSID /t REG_SZ /d {09571A4B-F1FE-4C60-9760-DE6D310C7C31} /f
REG ADD HKCR\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{09571A4B-F1FE-4C60-9760-DE6D310C7C31} ^
/v FilterData /t REG_BINARY /d 0200000000028000020000000000000030706933^
00000000000000000a00000000000000000000003074793300^
00000090010000a0010000317479330000000090010000b001^
0000327479330000000090010000c001000033747933000000^
0090010000d0010000347479330000000090010000e0010000^
357479330000000090010000f0010000367479330000000090^
01000000020000377479330000000090010000100200003874^
79330000000090010000200200003974793300000000900100^
00300200003170693308000000000000000b00000000000000^
00000000307479330000000090010000400200003174793300^
00000090010000500200003274793300000000900100006002^
00003374793300000000900100007002000034747933000000^
00900100008002000035747933000000009001000090020000^
367479330000000090010000a0020000377479330000000090^
010000b0020000387479330000000090010000c00200003974^
79330000000090010000d00200003a74793300000000900100^
00e00200007669647300001000800000aa00389b7161766331^
00001000800000aa00389b714156433100001000800000aa00^
389b716832363400001000800000aa00389b71483236340000^
1000800000aa00389b717832363400001000800000aa00389b^
715832363400001000800000aa00389b715653534800001000^
800000aa00389b71cb712d8d3f24e345b2d85fd7967ec09bad^
d2296f30e1aa45b42ff623ad354a9043435631000010008000^
00aa00389b715030313000001000800000aa00389b71503031^
3600001000800000aa00389b715956313200001000800000aa^
00389b714934323000001000800000aa00389b714e56313200^
001000800000aa00389b715955593200001000800000aa0038^
9b715559565900001000800000aa00389b717eeb36e44f52ce^
119f530020af0ba7707deb36e44f52ce119f530020af0ba770^
7beb36e44f52ce119f530020af0ba7707ceb36e44f52ce119f^
530020af0ba770 /f

:: --------------Register Core AVC decoder.----------------
regsvr32  -s CoreAVCDecoder.ax

:: ===========Registry hex data about haali===========
:: ----------------Haali Media Splitter hex data------------
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{55DA30FC-F16B-49FC-BAA5-AE59FC65F82D} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{55DA30FC-F16B-49FC-BAA5-AE59FC65F82D} ^
/v FriendlyName /d "Haali Media Splitter" /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{55DA30FC-F16B-49FC-BAA5-AE59FC65F82D} ^
/v CLSID /d {55DA30FC-F16B-49FC-BAA5-AE59FC65F82D} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{55DA30FC-F16B-49FC-BAA5-AE59FC65F82D} ^
/v FilterData /d 02000000010080000100000000000000307069330c00000000000000000000000000000000000000

:: -----------------Haali Media Splitter (AR) hex data-----------------
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{564FD788-86C9-4444-971E-CC4A243DA150} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{564FD788-86C9-4444-971E-CC4A243DA150} ^
/v FriendlyName /d "Haali Media Splitter (AR)"
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{564FD788-86C9-4444-971E-CC4A243DA150} ^
/v CLSID /d {564FD788-86C9-4444-971E-CC4A243DA150}
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{564FD788-86C9-4444-971E-CC4A243DA150} ^
/v FilterData /d 0200000000004000020000000000000030706933^
0c000000000000000000000000000000000000003170693300^
00000000000000010000000000000000000000307479330000^
0000500000006000000083eb36e44f52ce119f530020af0ba7^
704c2f9549dc3e9b4a89061de02a3d4bc2 /f

:: ------------------Haali Simple Media Splitter hex data------------------------
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{8F43B7D9-9D6B-4F48-BE18-4D787C795EEA} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{8F43B7D9-9D6B-4F48-BE18-4D787C795EEA} ^
/v FriendlyName /d "Haali Simple Media Splitter" /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{8F43B7D9-9D6B-4F48-BE18-4D787C795EEA} ^
/v CLSID /d {8F43B7D9-9D6B-4F48-BE18-4D787C795EEA} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{8F43B7D9-9D6B-4F48-BE18-4D787C795EEA} ^
/v FilterData /d 02000000000020000100000000000000307069330c00000000000000000000000000000000000000 /f

:: -----------------Haali Video Sink hex data---------------------------
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{F13D3732-96BD-4108-AFEB-E85F68FF64DC} /f
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{F13D3732-96BD-4108-AFEB-E85F68FF64DC} ^
/v FriendlyName /d "Haali Video Sink"
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{F13D3732-96BD-4108-AFEB-E85F68FF64DC} ^
/v CLSID /d {F13D3732-96BD-4108-AFEB-E85F68FF64DC}
REG ADD HKLM\SOFTWARE\Classes\CLSID\{083863F1-70DE-11D0-BD40-00A0C911CE86}\Instance\{F13D3732-96BD-4108-AFEB-E85F68FF64DC} ^
/v FilterData /d 0200000000002000010000000000000030706933^
00000000000000000100000000000000000000003074793300^
00000038000000480000007669647300001000800000aa0038^
9b7100000000000000000000000000000000 /f

:: --------------Register haali dll or ax----------------
regsvr32 -s avi.dll
regsvr32 -s mkx.dll
regsvr32 -s mp4.dll
regsvr32 -s ts.dll
regsvr32 -s splitter.ax